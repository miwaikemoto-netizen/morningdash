<script>
(function(){
  // 入力（YYYY-MM-DD） → YYYY/M/D へ
  function ymdFromInputOrToday(){
    const inp = document.querySelector('#datePicker');
    if (inp?.value) {
      const [y,m,d] = inp.value.split('-');
      return `${y}/${+m}/${+d}`;
    }
    const dt = new Date();
    return `${dt.getFullYear()}/${dt.getMonth()+1}/${dt.getDate()}`;
  }
  function syncCalendarLink(){
    const ymd = ymdFromInputOrToday();
    const u = new URL('v12_calendar.html', location.href);
    u.searchParams.set('date', ymd);
    const a = document.getElementById('btnOpenCalendar');
    if (a) a.href = u.toString();
  }
  // 初期化＋日付変更で更新
  syncCalendarLink();
  const inp = document.querySelector('#datePicker');
  if (inp) inp.addEventListener('change', syncCalendarLink);
})();
</script>
